{"title":"Results","markdown":{"yaml":{"title":"Results","bibliography":"references.bib"},"headingText":"K-means Implementation","containsRefs":false,"markdown":"\n\n\nThe k-means algorithm will be applied to partition Brazilian municipalities into\nclusters based on health-related indicators. This serves as a baseline method\nfor regionalization, providing a simple, well-known clustering approach against\nwhich more sophisticated models (e.g., Bayesian space-time partitioning) can be\nevaluated.\n\n#### 1. Mathematical Definition\n\nGiven a set of $n$ observations $\\mathbf{X} = \\{x_1, x_2, \\ldots, x_n\\}\n$, where each $x_i \\in \\mathbb{R}^d$ is a $d $-dimensional feature\nvector representing health data for a municipality, the k-means algorithm\npartitions the data into $k$ disjoint clusters $C = \\{C_1, C_2, \\ldots,\nC_k\\}$ such that the **within-cluster sum of squares (WCSS)** is minimized:\n\n$$\n\\underset{C}{\\arg\\min} \\sum_{j=1}^{k} \\sum_{x_i \\in C_j} \\|x_i - \\mu_j\\|^2\n$$\n\nwhere:\n\n- $\\mu_j$ is the centroid (mean) of cluster $C_j$, computed as:\n$$\n\\mu_j = \\frac{1}{|C_j|} \\sum_{x_i \\in C_j} x_i\n$$\n\n- $\\|\\cdot\\|$ denotes the Euclidean norm.\n\nThe objective is to find a partition where municipalities within the same\ncluster are as similar as possible, based on their health profiles.\n\n#### 2. Number of Clusters ($k$)\n\nChoosing the appropriate number of clusters $k$ is crucial. While it can be\ninformed by domain knowledge (e.g., number of official health regions), we will\nalso use two data-driven methods:\n\n- **Elbow Method**:  \n  Plot the total WCSS as a function of $k$ and look for the \"elbow\" point\n  where the rate of decrease sharply changes.\n\n- **Silhouette Score**:  \n  For each point, the silhouette score compares the average distance to other\n  points in the same cluster with the average distance to points in the nearest\n  neighboring cluster. The optimal $k$ maximizes the average silhouette\n  score across all points.\n\n#### 3. Initialization of Centroids\n\n- **Random Initialization**:  \n  Select $k$ random observations as initial centroids. This can lead to poor\n  or inconsistent results depending on the starting points.\n\n- **K-means++**:  \n  Improves initialization by choosing the first centroid randomly and the\n  remaining ones probabilistically based on their distance from already selected\n  centroids. This method helps avoid poor clustering outcomes and accelerates\n  convergence.\n\n#### 4. Algorithm Steps\n\nThe k-means algorithm follows an iterative procedure:\n\n1. **Initialization**: Choose initial centroids $\\mu_1, \\ldots, \\mu_k$.\n2. **Assignment Step**: Assign each point $x_i$ to the nearest centroid:\n\n$$\n\\text{Assign } x_i \\text{ to } C_j \\text{ where } j = \\arg\\min_{l \\in \\{1,\n\\ldots, k\\}} \\|x_i - \\mu_l\\|^2\n$$\n\n3. **Update Step**: Recalculate each centroid:\n$$\n\\mu_j = \\frac{1}{|C_j|} \\sum_{x_i \\in C_j} x_i\n$$\n\n4. **Convergence Check**: Repeat steps 2 and 3 until:\n   - Cluster assignments do not change; or\n   - A maximum number of iterations is reached.\n\n#### 5. Distance Metric\n\nWe will use the **Euclidean distance** as the default metric for similarity:\n\n$$\nd(x_i, x_j) = \\|x_i - x_j\\|_2 = \\sqrt{\\sum_{l=1}^{d} (x_{il} - x_{jl})^2}\n$$\n\nSince health indicators may be on different scales (e.g., hospital beds vs.\nmortality rates), features will be **standardized** before clustering to ensure\ncomparability.\n\n#### 6. **Post-Processing and Evaluation**\n\nAfter clustering:\n\n- We will **map the clusters spatially** to examine whether the partitions\n  correspond to geographic or administrative patterns.\n- The results will be compared with:\n  - Official health regions (e.g., IBGE-defined or Ministry of Health regions),\n  - REGIC 2018 functional regions.\n\nEvaluation metrics will include:\n\n- **Clustering agreement**:\n  - Rand Index\n  - Jaccard Index\n  - F1-Score\n\n- **Health indicator error measures**:\n  - Mean Absolute Error (MAE)\n  - Mean Squared Error (MSE)\n\nThese comparisons will help assess the degree to which k-means can approximate\nexisting regional structures and whether it captures relevant patterns in the\nhealth data.\n","srcMarkdownNoYaml":"\n\n### K-means Implementation\n\nThe k-means algorithm will be applied to partition Brazilian municipalities into\nclusters based on health-related indicators. This serves as a baseline method\nfor regionalization, providing a simple, well-known clustering approach against\nwhich more sophisticated models (e.g., Bayesian space-time partitioning) can be\nevaluated.\n\n#### 1. Mathematical Definition\n\nGiven a set of $n$ observations $\\mathbf{X} = \\{x_1, x_2, \\ldots, x_n\\}\n$, where each $x_i \\in \\mathbb{R}^d$ is a $d $-dimensional feature\nvector representing health data for a municipality, the k-means algorithm\npartitions the data into $k$ disjoint clusters $C = \\{C_1, C_2, \\ldots,\nC_k\\}$ such that the **within-cluster sum of squares (WCSS)** is minimized:\n\n$$\n\\underset{C}{\\arg\\min} \\sum_{j=1}^{k} \\sum_{x_i \\in C_j} \\|x_i - \\mu_j\\|^2\n$$\n\nwhere:\n\n- $\\mu_j$ is the centroid (mean) of cluster $C_j$, computed as:\n$$\n\\mu_j = \\frac{1}{|C_j|} \\sum_{x_i \\in C_j} x_i\n$$\n\n- $\\|\\cdot\\|$ denotes the Euclidean norm.\n\nThe objective is to find a partition where municipalities within the same\ncluster are as similar as possible, based on their health profiles.\n\n#### 2. Number of Clusters ($k$)\n\nChoosing the appropriate number of clusters $k$ is crucial. While it can be\ninformed by domain knowledge (e.g., number of official health regions), we will\nalso use two data-driven methods:\n\n- **Elbow Method**:  \n  Plot the total WCSS as a function of $k$ and look for the \"elbow\" point\n  where the rate of decrease sharply changes.\n\n- **Silhouette Score**:  \n  For each point, the silhouette score compares the average distance to other\n  points in the same cluster with the average distance to points in the nearest\n  neighboring cluster. The optimal $k$ maximizes the average silhouette\n  score across all points.\n\n#### 3. Initialization of Centroids\n\n- **Random Initialization**:  \n  Select $k$ random observations as initial centroids. This can lead to poor\n  or inconsistent results depending on the starting points.\n\n- **K-means++**:  \n  Improves initialization by choosing the first centroid randomly and the\n  remaining ones probabilistically based on their distance from already selected\n  centroids. This method helps avoid poor clustering outcomes and accelerates\n  convergence.\n\n#### 4. Algorithm Steps\n\nThe k-means algorithm follows an iterative procedure:\n\n1. **Initialization**: Choose initial centroids $\\mu_1, \\ldots, \\mu_k$.\n2. **Assignment Step**: Assign each point $x_i$ to the nearest centroid:\n\n$$\n\\text{Assign } x_i \\text{ to } C_j \\text{ where } j = \\arg\\min_{l \\in \\{1,\n\\ldots, k\\}} \\|x_i - \\mu_l\\|^2\n$$\n\n3. **Update Step**: Recalculate each centroid:\n$$\n\\mu_j = \\frac{1}{|C_j|} \\sum_{x_i \\in C_j} x_i\n$$\n\n4. **Convergence Check**: Repeat steps 2 and 3 until:\n   - Cluster assignments do not change; or\n   - A maximum number of iterations is reached.\n\n#### 5. Distance Metric\n\nWe will use the **Euclidean distance** as the default metric for similarity:\n\n$$\nd(x_i, x_j) = \\|x_i - x_j\\|_2 = \\sqrt{\\sum_{l=1}^{d} (x_{il} - x_{jl})^2}\n$$\n\nSince health indicators may be on different scales (e.g., hospital beds vs.\nmortality rates), features will be **standardized** before clustering to ensure\ncomparability.\n\n#### 6. **Post-Processing and Evaluation**\n\nAfter clustering:\n\n- We will **map the clusters spatially** to examine whether the partitions\n  correspond to geographic or administrative patterns.\n- The results will be compared with:\n  - Official health regions (e.g., IBGE-defined or Ministry of Health regions),\n  - REGIC 2018 functional regions.\n\nEvaluation metrics will include:\n\n- **Clustering agreement**:\n  - Rand Index\n  - Jaccard Index\n  - F1-Score\n\n- **Health indicator error measures**:\n  - Mean Absolute Error (MAE)\n  - Mean Squared Error (MSE)\n\nThese comparisons will help assess the degree to which k-means can approximate\nexisting regional structures and whether it captures relevant patterns in the\nhealth data.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"05_results.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","number-depth":2,"theme":"cosmo","title":"Results","bibliography":["references.bib"]},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"05_results.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"number-depth":2,"documentclass":"scrreprt","title":"Results","bibliography":["references.bib"]},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}